{"ast":null,"code":"import _slicedToArray from\"/Users/doanhtran/Downloads/GitHub/tax-calculator/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/*global chrome*/import React,{useEffect,useState}from'react';import ReactDOM from'react-dom';import\"./content.css\";import Frame,{FrameContextConsumer}from'react-frame-component';import InputBox from'./components/inputbox/inputBox';import ReportForm from'./components/reportForm';var PRICE='price';var COORDS='coords';function Tax(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),price=_useState2[0],setPrice=_useState2[1];// const [x, setX] = useState(0)\n// const [y, setY] = useState(0)\n//&& typeof(request.priceInfo) === \"number\"\nuseEffect(function(){chrome.extension.onMessage.addListener(function(request,sender,sendResponse){console.log('received some info');console.log('type: ',request.type);if(request.type===PRICE){console.log(\"modifying DOM\");setPrice(request.price);getDOM(request.price);sendResponse({save:true});}});});// document.addEventListener('click', saveMousePos);\n// function saveMousePos(event) {\n//     setX(event.clientX)\n//     setY(event.clientY)\n//     console.log(event.clientX)\n//     console.log(event.clientY)\n// }\nreturn/*#__PURE__*/React.createElement(Frame,{head:[/*#__PURE__*/React.createElement(\"link\",{type:\"text/css\",rel:\"stylesheet\",href:chrome.runtime.getURL(\"/static/css/content.css\")})]},/*#__PURE__*/React.createElement(FrameContextConsumer,null,// Callback is invoked with iframe's window and document instances\nfunction(_ref){var document=_ref.document,window=_ref.window;// Render Children\nreturn/*#__PURE__*/React.createElement(\"div\",{className:\"my-extension\"},/*#__PURE__*/React.createElement(\"h1\",null,\"This is the price after taxes: \",price));}));}var app=document.createElement('div');app.id=\"my-extension-root\";document.body.appendChild(app);ReactDOM.render(/*#__PURE__*/React.createElement(Tax,null),app);document.addEventListener('click',saveMousePos);function saveMousePos(event){console.log(event.clientX);console.log(event.clientY);var app=document.getElementById(\"my-extension-root\");app.style.position=\"absolute\";app.style.left=event.clientX+'px';app.style.top=event.clientY+'px';}function getDOM(tax){//var list = []\nfunction findDollarSign(node){if(node.nodeType===3){var dollarIndex=node.nodeValue.indexOf('$');if(dollarIndex!==-1){//list.append(node);\nvar parentEl=node.parentElement;var classname=parentEl.className;var price=findPrice(node.nodeValue.slice(dollarIndex+1),1.08);var original=node.nodeValue;parentEl.addEventListener('mouseenter',function(event){price===null?node.nodeValue=original:node.nodeValue='$'+price;});parentEl.addEventListener('mouseleave',function(event){node.nodeValue=original;});list.push(classname);// console.log(list);\n// console.log('$ node');\n// console.log (\"classname: \", classname);\n}}//console.log('no $');\nif(node.hasChildNodes()){var children=node.childNodes;for(var i=0;i<children.length;i++){findDollarSign(children[i]);}}}/* Find value after the dollar sign and multiply by tax. Returns null if there is no price \n    after the dollar sign.\n    Parameters: \n    text is text after the dollar sign\n    tax is the tax rate (e.g 1.08)\n    Precondition: text is a string */function findPrice(text,tax){var price='';for(var i=0;i<text.length;i++){var ascii=text.charCodeAt(i);if(ascii===32||ascii===44||ascii===46||48<=ascii&&ascii<=57){if(ascii!==44)price=price+text.substr(i,1);}else{break;}}var value=parseFloat(price)*tax;console.log(\"price:\",value);if(isNaN(price))return null;var whole=Math.floor(value).toString();//console.log(\"whole:\", whole);\nvar dec=(value-whole).toFixed(2).toString().slice(1);//console.log(\"dec:\", dec);\nprice=commatize(whole)+dec;return price;}function commatize(price){if(price.length<4){return price;}var lastThree=price.slice(-3);var begin=commatize(price.slice(0,-3));return begin+','+lastThree;}var list=[];findDollarSign(document);return list;}","map":{"version":3,"sources":["/Users/doanhtran/Downloads/GitHub/tax-calculator/src/content.js"],"names":["React","useEffect","useState","ReactDOM","Frame","FrameContextConsumer","InputBox","ReportForm","PRICE","COORDS","Tax","price","setPrice","chrome","extension","onMessage","addListener","request","sender","sendResponse","console","log","type","getDOM","save","runtime","getURL","document","window","app","createElement","id","body","appendChild","render","addEventListener","saveMousePos","event","clientX","clientY","getElementById","style","position","left","top","tax","findDollarSign","node","nodeType","dollarIndex","nodeValue","indexOf","parentEl","parentElement","classname","className","findPrice","slice","original","list","push","hasChildNodes","children","childNodes","i","length","text","ascii","charCodeAt","substr","value","parseFloat","isNaN","whole","Math","floor","toString","dec","toFixed","commatize","lastThree","begin"],"mappings":"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","sourcesContent":[" /*global chrome*/\nimport React, {useEffect, useState} from 'react'; \nimport ReactDOM from 'react-dom';\nimport \"./content.css\";\nimport Frame, { FrameContextConsumer }from 'react-frame-component';\nimport InputBox from './components/inputbox/inputBox';\nimport ReportForm from './components/reportForm';\n\nvar PRICE = 'price';\nvar COORDS = 'coords';\n\nfunction Tax() {\n\n    const [price, setPrice] = useState(0)\n    // const [x, setX] = useState(0)\n    // const [y, setY] = useState(0)\n\n    //&& typeof(request.priceInfo) === \"number\"\n\n    useEffect(() => {\n        chrome.extension.onMessage.addListener(\n            function(request, sender, sendResponse) {\n                console.log('received some info');\n                console.log('type: ', request.type);\n                if (request.type === PRICE ) {\n                    console.log(\"modifying DOM\")\n                    setPrice(request.price);\n                    getDOM(request.price);\n                    sendResponse({save: true});\n                }\n            });\n    })\n\n    // document.addEventListener('click', saveMousePos);\n\n    // function saveMousePos(event) {\n    //     setX(event.clientX)\n    //     setY(event.clientY)\n    //     console.log(event.clientX)\n    //     console.log(event.clientY)\n    // }\n\n    \n\n    return (\n        <Frame head={[<link type=\"text/css\" rel=\"stylesheet\" href={chrome.runtime.getURL(\"/static/css/content.css\")} ></link>]}> \n              <FrameContextConsumer>\n               {\n               // Callback is invoked with iframe's window and document instances\n                   ({document, window}) => {\n                      // Render Children\n                      return (\n                        <div className='my-extension'>\n                            <h1>This is the price after taxes: {price}</h1>\n                            {/*<InputBox />\n                            <ReportForm />*/}\n                        </div>\n                      )\n                   }\n                }\n               </FrameContextConsumer>\n            </Frame>\n    )\n\n}\n\nconst app = document.createElement('div');\napp.id = \"my-extension-root\";\ndocument.body.appendChild(app);\nReactDOM.render(<Tax />, app);\n\ndocument.addEventListener('click', saveMousePos);\n\nfunction saveMousePos(event) {\n    console.log(event.clientX)\n    console.log(event.clientY)\n    var app = document.getElementById(\"my-extension-root\");\n    app.style.position = \"absolute\";\n    app.style.left = event.clientX+'px';\n    app.style.top = event.clientY+'px';\n}\n\n\nfunction getDOM(tax){\n    //var list = []\n\n    function findDollarSign(node){\n        if (node.nodeType === 3){\n            const dollarIndex = node.nodeValue.indexOf('$')\n            if(dollarIndex !== -1 ) {\n            \n                //list.append(node);\n                const parentEl = node.parentElement\n                const classname = parentEl.className;\n\n                const price = findPrice(node.nodeValue.slice(dollarIndex+1), 1.08)\n\n                const original = node.nodeValue;\n                parentEl.addEventListener('mouseenter', event => {\n                    price === null ? node.nodeValue = original : node.nodeValue = '$' + price;\n                })\n                parentEl.addEventListener('mouseleave', event =>{\n                    node.nodeValue = original;\n                })\n                list.push(classname);\n                // console.log(list);\n                // console.log('$ node');\n                // console.log (\"classname: \", classname);\n            }\n        }\n        //console.log('no $');\n        if (node.hasChildNodes()){\n            let children = node.childNodes;  \n            for (let i = 0; i < children.length; i++){\n                findDollarSign(children[i]);\n            }      \n        }\n    }\n   \n\n    /* Find value after the dollar sign and multiply by tax. Returns null if there is no price \n    after the dollar sign.\n    Parameters: \n    text is text after the dollar sign\n    tax is the tax rate (e.g 1.08)\n    Precondition: text is a string */\n    function findPrice(text, tax){\n        let price = '';\n        for(let i = 0; i<text.length; i++){\n            let ascii = text.charCodeAt(i);\n            if (ascii === 32 || ascii === 44 || ascii === 46 || (48 <= ascii && ascii <= 57)){\n                if (ascii !== 44) price = price + text.substr(i,1);\n            }\n            else{\n                break;\n            }\n        }\n\n        let value = (parseFloat(price) * tax);\n        console.log(\"price:\", value);\n\n        if(isNaN(price)) return null;\n\n        const whole = Math.floor(value).toString();\n        //console.log(\"whole:\", whole);\n        const dec = (value - whole).toFixed(2).toString().slice(1);\n        //console.log(\"dec:\", dec);\n        price = commatize(whole) + dec;\n\n        return price;\n    }\n\n    function commatize(price){\n        if(price.length<4){\n            return price;\n        }\n        let lastThree = price.slice(-3);\n        let begin = commatize(price.slice(0,-3));\n        return begin + ',' + lastThree;\n    }\n\n\n    var list =[];\n\n    findDollarSign(document);\n    return list;\n}"]},"metadata":{},"sourceType":"module"}