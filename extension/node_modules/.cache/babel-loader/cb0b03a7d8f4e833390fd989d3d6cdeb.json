{"ast":null,"code":"var _jsxFileName = \"/Users/mina/Desktop/tax_calculator/src/content.js\";\n\n/*global chrome*/\nimport React, { useEffect, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport \"./content.css\"; //import Frame, { FrameContextConsumer }from 'react-frame-component';\n// import InputBox from './components/inputbox/inputBox';\n// import ReportForm from './components/reportForm';\n\nvar PRICE = 'price'; //var COORDS = 'coords';\n\nfunction Tax() {\n  const [price, setPrice] = useState(0); // const [x, setX] = useState(0)\n  // const [y, setY] = useState(0)\n  //&& typeof(request.priceInfo) === \"number\"\n\n  useEffect(() => {\n    chrome.extension.onMessage.addListener(function (request, sender, sendResponse) {\n      console.log('received some info');\n      console.log('type: ', request.type);\n\n      if (request.type === PRICE) {\n        console.log(\"modifying DOM\");\n        setPrice(request.price);\n        getDOM(price);\n        sendResponse({\n          save: true\n        });\n      }\n    });\n  }); // document.addEventListener('click', saveMousePos);\n  // function saveMousePos(event) {\n  //     setX(event.clientX)\n  //     setY(event.clientY)\n  //     console.log(event.clientX)\n  //     console.log(event.clientY)\n  // }\n\n  return null;\n  {\n    /* <Frame head={[<link type=\"text/css\" rel=\"stylesheet\" href={chrome.runtime.getURL(\"/static/css/content.css\")} ></link>]}> \n        <FrameContextConsumer>\n          {\n          //Callback is invoked with iframe's window and document instances\n              ({document, window}) => {\n                 // Render Children\n                 return (\n                   <div className='my-extension'>\n                       <h1>This is the price after taxes: {price}</h1>\n                   </div>\n                 )\n              }\n           }\n          </FrameContextConsumer>\n       </Frame> */\n  }\n}\n\nconst app = document.createElement('div');\napp.id = \"my-extension-root\";\ndocument.body.appendChild(app);\nReactDOM.render( /*#__PURE__*/React.createElement(Tax, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 17\n  }\n}), app);\ndocument.addEventListener('click', saveMousePos);\n\nfunction saveMousePos(event) {\n  console.log(event.clientX);\n  console.log(event.clientY);\n  var app = document.getElementById(\"my-extension-root\");\n  app.style.position = \"absolute\";\n  app.style.left = event.clientX + 'px';\n  app.style.top = event.clientY + 'px';\n}\n\nfunction getDOM(tax) {\n  //var list = []\n  function findDollarSign(node) {\n    if (node.nodeType === 3) {\n      const dollarIndex = node.nodeValue.indexOf('$');\n\n      if (dollarIndex !== -1) {\n        //list.append(node);\n        const parentEl = node.parentElement;\n        const classname = parentEl.className;\n        const price = findPrice(node.nodeValue.slice(dollarIndex + 1), 1.08);\n        const original = node.nodeValue;\n        parentEl.addEventListener('mouseenter', event => {\n          price === null ? node.nodeValue = original : node.nodeValue = '$' + price;\n        });\n        parentEl.addEventListener('mouseleave', event => {\n          node.nodeValue = original;\n        });\n        list.push(classname); // console.log(list);\n        // console.log('$ node');\n        // console.log (\"classname: \", classname);\n      }\n    } //console.log('no $');\n\n\n    if (node.hasChildNodes()) {\n      let children = node.childNodes;\n\n      for (let i = 0; i < children.length; i++) {\n        findDollarSign(children[i]);\n      }\n    }\n  }\n  /* Find value after the dollar sign and multiply by tax.\n  Returns null if there is no price after the dollar sign.\n  Parameters: \n  text is text after the dollar sign\n  tax is the tax rate (e.g 1.08)\n  Precondition: text is a string */\n\n\n  function findPrice(text, tax) {\n    let price = '';\n\n    for (let i = 0; i < text.length; i++) {\n      let ascii = text.charCodeAt(i);\n\n      if (ascii === 32 || ascii === 44 || ascii === 46 || 48 <= ascii && ascii <= 57) {\n        if (ascii !== 44) price = price + text.substr(i, 1);\n      } else {\n        break;\n      }\n    }\n\n    let value = parseFloat(price) * tax;\n    console.log(\"price:\", value);\n    if (isNaN(price)) return null;\n    const whole = Math.floor(value).toString(); //console.log(\"whole:\", whole);\n\n    const dec = (value - whole).toFixed(2).toString().slice(1); //console.log(\"dec:\", dec);\n\n    price = commatize(whole) + dec;\n    return price;\n  }\n\n  function commatize(price) {\n    if (price.length < 4) {\n      return price;\n    }\n\n    let lastThree = price.slice(-3);\n    let begin = commatize(price.slice(0, -3));\n    return begin + ',' + lastThree;\n  }\n\n  var list = [];\n  findDollarSign(document);\n  return list;\n}","map":{"version":3,"sources":["/Users/mina/Desktop/tax_calculator/src/content.js"],"names":["React","useEffect","useState","ReactDOM","PRICE","Tax","price","setPrice","chrome","extension","onMessage","addListener","request","sender","sendResponse","console","log","type","getDOM","save","app","document","createElement","id","body","appendChild","render","addEventListener","saveMousePos","event","clientX","clientY","getElementById","style","position","left","top","tax","findDollarSign","node","nodeType","dollarIndex","nodeValue","indexOf","parentEl","parentElement","classname","className","findPrice","slice","original","list","push","hasChildNodes","children","childNodes","i","length","text","ascii","charCodeAt","substr","value","parseFloat","isNaN","whole","Math","floor","toString","dec","toFixed","commatize","lastThree","begin"],"mappings":"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","sourcesContent":[" /*global chrome*/\nimport React, {useEffect, useState} from 'react'; \nimport ReactDOM from 'react-dom';\nimport \"./content.css\";\n//import Frame, { FrameContextConsumer }from 'react-frame-component';\n// import InputBox from './components/inputbox/inputBox';\n// import ReportForm from './components/reportForm';\n\nvar PRICE = 'price';\n//var COORDS = 'coords';\n\nfunction Tax() {\n\n    const [price, setPrice] = useState(0)\n    // const [x, setX] = useState(0)\n    // const [y, setY] = useState(0)\n\n    //&& typeof(request.priceInfo) === \"number\"\n\n    useEffect(() => {\n        chrome.extension.onMessage.addListener(\n            function(request, sender, sendResponse) {\n                console.log('received some info');\n                console.log('type: ', request.type);\n                if (request.type === PRICE ) {\n                    console.log(\"modifying DOM\")\n                    setPrice(request.price);\n                    getDOM(price);\n                    sendResponse({save: true});\n                }\n            }\n        );\n    })\n\n    // document.addEventListener('click', saveMousePos);\n\n    // function saveMousePos(event) {\n    //     setX(event.clientX)\n    //     setY(event.clientY)\n    //     console.log(event.clientX)\n    //     console.log(event.clientY)\n    // }\n\n    \n\n    return null\n        \n        {/* <Frame head={[<link type=\"text/css\" rel=\"stylesheet\" href={chrome.runtime.getURL(\"/static/css/content.css\")} ></link>]}> \n             <FrameContextConsumer>\n               {\n               //Callback is invoked with iframe's window and document instances\n                   ({document, window}) => {\n                      // Render Children\n                      return (\n                        <div className='my-extension'>\n                            <h1>This is the price after taxes: {price}</h1>\n                        </div>\n                      )\n                   }\n                }\n               </FrameContextConsumer>\n            </Frame> */}\n    \n\n}\n\nconst app = document.createElement('div');\napp.id = \"my-extension-root\";\ndocument.body.appendChild(app);\nReactDOM.render(<Tax />, app);\n\ndocument.addEventListener('click', saveMousePos);\n\nfunction saveMousePos(event) {\n    console.log(event.clientX)\n    console.log(event.clientY)\n    var app = document.getElementById(\"my-extension-root\");\n    app.style.position = \"absolute\";\n    app.style.left = event.clientX+'px';\n    app.style.top = event.clientY+'px';\n}\n\n\nfunction getDOM(tax){\n    //var list = []\n\n    function findDollarSign(node){\n        if (node.nodeType === 3){\n            const dollarIndex = node.nodeValue.indexOf('$')\n            if(dollarIndex !== -1 ) {\n            \n                //list.append(node);\n                const parentEl = node.parentElement\n                const classname = parentEl.className;\n\n                const price = findPrice(node.nodeValue.slice(dollarIndex+1), 1.08)\n\n                const original = node.nodeValue;\n                parentEl.addEventListener('mouseenter', event => {\n                    price === null ? node.nodeValue = original : node.nodeValue = '$' + price;\n                })\n                parentEl.addEventListener('mouseleave', event =>{\n                    node.nodeValue = original;\n                })\n                list.push(classname);\n                // console.log(list);\n                // console.log('$ node');\n                // console.log (\"classname: \", classname);\n            }\n        }\n        //console.log('no $');\n        if (node.hasChildNodes()){\n            let children = node.childNodes;  \n            for (let i = 0; i < children.length; i++){\n                findDollarSign(children[i]);\n            }      \n        }\n    }\n   \n\n    /* Find value after the dollar sign and multiply by tax.\n    Returns null if there is no price after the dollar sign.\n    Parameters: \n    text is text after the dollar sign\n    tax is the tax rate (e.g 1.08)\n    Precondition: text is a string */\n    function findPrice(text, tax){\n        let price = '';\n        for(let i = 0; i<text.length; i++){\n            let ascii = text.charCodeAt(i);\n            if (ascii === 32 || ascii === 44 || ascii === 46 || (48 <= ascii && ascii <= 57)){\n                if (ascii !== 44) price = price + text.substr(i,1);\n            }\n            else{\n                break;\n            }\n        }\n\n        let value = (parseFloat(price) * tax);\n        console.log(\"price:\", value);\n\n        if(isNaN(price)) return null;\n\n        const whole = Math.floor(value).toString();\n        //console.log(\"whole:\", whole);\n        const dec = (value - whole).toFixed(2).toString().slice(1);\n        //console.log(\"dec:\", dec);\n        price = commatize(whole) + dec;\n\n        return price;\n    }\n\n    function commatize(price){\n        if(price.length<4){\n            return price;\n        }\n        let lastThree = price.slice(-3);\n        let begin = commatize(price.slice(0,-3));\n        return begin + ',' + lastThree;\n    }\n\n\n    var list =[];\n\n    findDollarSign(document);\n    return list;\n}"]},"metadata":{},"sourceType":"module"}